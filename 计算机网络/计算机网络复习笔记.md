# 计算机网络秋招复习笔记

## 一、概述

### 	1.1 什么是互联网？

​		互联网（internet），又称国际网络，指的是网络与网络之间所串连成的庞大网络，这些网络以一组通用的协议相连，形成逻辑上的单一巨大国际网络。互联网具有**连通性**和**共享性**。



### 	1.2 互联网概述

- 网络：由若干**结点**（计算机、集线器、交换器、路由器）和连接这些结点的**链路**组成。
- 互连网：把网络通过路由器互连起来（网络的网络）。
- 互联网：全球范围的互连网。

网络把许多计算机连接在一起，而互连网则是把许多网络通过路由器连接在一起。与网络相连的计算机常称为主机。



### 	1.3 互连网基础结构发展三个阶段

- 第一阶段：从单个网络ARPANET（一个单个的分组交换网，所有要连接在ARPANET上的主机都直接与就近的结点交换机相连）向互连网发展的过程。

- 第二阶段：三级结构的互联网NSFNET。分为**主干网**、**地区网**、**校园/企业网**。

- 第三阶段：多层次**ISP**结构的互联网。ISP(Internet Service Provider)互联网服务提供商（电信、移动、联通）

  当前来说，所谓上网就是通过ISP获得IP地址接入互联网。

![image-20200703171635162](计算机网络复习笔记.assets/ISP.png)



### 		1.4 ISP

​	ISP也分为不同层级：主干ISP、地区ISP、本地ISP

- 主干ISP，由几个专门的公司创建和维持，服务面积较大（一般能够覆盖国家范围），并且还拥有高速主干网。
- 地区ISP，一些较小的ISP，这些地区ISP通过一个或多个主干ISP连接起来。
- 本地ISP，给用户提供直接的服务，本地ISP可以连接到地区ISP，也可以直接连接到主干ISP
- 互联网交换点IXP（Internet eXchange Point），其作用就是允许两个网络直接相连并交换分组，而不需要再连通第三个网络来转发分组。使得互联网上的数据流量分布更加合理，同时也减少了分组转发的延迟时间，降低了分组转发的费用。



### 1.5 互联网的组成

​		互联网分为两大块：**边缘部分**（用户直接使用，用来进行通信和资源共享）、**核心部分**（由大量的网络和连接这些网络的路由器组成，为边缘部分提供服务）。



### 1.6 边缘部分的通信

- 客户-服务器方式（C/S）：客户（client）是服务请求方，服务器（server）是服务提供方
- 对等方式（P2P）：没有服务、客户之分，双方可以下载对方已经存储在硬盘中的共享文档。可支持大量对等用户同时工作。



### 1.7 核心部分的通信

​		网络核心部分中起特殊作用的是路由器，是实现分组交换的关键构建，其任务是转发收到的分组。

- 电路交换：电路交换用于电话通信系统，两个用户要通信之前需要建立一条**专用的物理链路**，并且在整个通信过程中**始终占用**该链路。由于通信的过程中不可能一直在使用传输线路，因此电路交换对线路的利用率很低，往往不到 10%，甚至1%。
- 报文交换：整个报文先传送到相邻结点，全部存储后查找转发表再转发到下个结点。
- 分组交换：每个分组都有首部和尾部，包含了源地址和目的地址等控制信息，在同一个传输线路上同时传输多个分组互相不会影响，因此在同一条传输线路上允许同时传输多个分组，也就是说分组交换不需要占用传输线路。高效、灵活、迅速、可靠。可能会有时延。



### 1.8 计算机网络的性能

- 速率：数据的传送速率，也叫数据率、比特率。在通信领域中，小写k代表1000，大写K既可以代表1000也可以代表1024。

- 带宽：网络中某通道传送数据的能力，表示在单位时间内网络中的某信道所能通过的最高数据率。

- 吞吐量：表示在单位时间内通过某个网络的实际的数据量。

- 时延：数据从网络的一端传送到另一端所需的时间。

  - 发送时延：主机或路由器发送数据帧所需要的的时间。
    $$
    发送时延=\frac{数据帧长度（bit）}{发送速率（bit/s）}
    $$

  - 传播时延：电磁波在信道中传播一定的距离需要花费的时间
    $$
    传播时延=\frac{信道长度（m）}{电磁波在信道上的传播速率（m/s）}
    $$

  - 处理时延：主机或路由收到分组时要花费一定的时间进行处理

  - 排队时延：分组进入路由器后要现在输入队列中排队等待处理、等待转发。

  - 总时延 = 发送时延+传播时延+处理时延+排队时延。

    ```markdown
    例题：收发两端之间的传输距离为1000km，信号在媒体上的传播速率为2*8^10m/s。试计算以下两种情况的发送时延和传播时延：
    （1） 数据长度为10^7bit，数据发送速率为100kbit/s
    （2） 数据长度为10^3bit，数据发送速率为1Gbit/s
    解：（1）发送时延=10^7bit/10^4(bit/s) = 10^3 s
    传播时延=10^5m/2*8^10（m/s） = 5*10^-4s
    （2） 发送时延 = 10^3bit/10^9(bit/s) = 10^-6s
    传播时延同1
    ```

    

- 时延带宽积：传播时延*带宽

- 往返时间RTT
  $$
  发送时间=\frac{数据长度}{发送速率}
  $$

  $$
  有效数据率=\frac{数据长度}{发送时间+RTT}
  $$

- 利用率
  $$
  D（网络当前的时延）= \frac{D0（网络空闲时的时延）}{1-U（利用率）}
  $$



### 1.9 计算机网络体系结构

1. 五层协议

-   **应用层**  ：为特定应用程序提供数据传输服务，例如 HTTP、DNS 等协议。数据单位为报文。

-   **传输层**  ：为进程提供通用数据传输服务。由于应用层协议很多，定义通用的传输层协议就可以支持不断增多的应用层协议。运输层包括两种协议：传输控制协议 TCP，提供面向连接、可靠的数据传输服务，数据单位为报文段；用户数据报协议 UDP，提供无连接、尽最大努力的数据传输服务，数据单位为用户数据报。TCP 主要提供完整性服务，UDP 主要提供及时性服务。

-   **网络层**  ：为主机提供数据传输服务。而传输层协议是为主机中的进程提供数据传输服务。网络层把传输层传递下来的报文段或者用户数据报封装成分组。

-   **数据链路层**  ：网络层针对的还是主机之间的数据传输服务，而主机之间可以有很多链路，链路层协议就是为同一链路的主机提供数据传输服务。数据链路层把网络层传下来的分组封装成帧。

-   **物理层**  ：考虑的是怎样在传输媒体上传输数据比特流，而不是指具体的传输媒体。物理层的作用是尽可能屏蔽传输媒体和通信手段的差异，使数据链路层感觉不到这些差异。

2. OSI

其中表示层和会话层用途如下：

-   **表示层**  ：数据压缩、加密以及数据描述，这使得应用程序不必关心在各台主机中数据内部格式不同的问题。

-   **会话层**  ：建立及管理会话。

五层协议没有表示层和会话层，而是将这些功能留给应用程序开发者处理。

3. TCP/IP

它只有四层，相当于五层协议中数据链路层和物理层合并为**网络接口层**。

TCP/IP 体系结构不严格遵循 OSI 分层概念，应用层可能会直接使用 IP 层或者网络接口层。



## 二、物理层

### 2.1 物理层的基本概念

- 物理层考虑的是怎么样才能在连接各种计算机的传输媒体上传输数据比特流，而不是指具体的传输媒体。

### 2.2 信道

- **单向通信**（单工通信），只能有一个方向的通信而没有反方向的交互。
- **双向交替通信**（半双工通信），双方都可以发送消息，但不能同时发送。
- **双向同时通信**（全双工通信），双方可以同时发送和接受消息。

### 2.3 常用编码方式

- **不归零制**，正电平=1，负电平=0

- **归零制**， 正脉冲=1，负脉冲=0

- **曼彻斯特编码**，位周期中心的向上跳变=0，位周期中心的向下跳变=1，也可反过来定义

- **差分曼彻斯特编码**，每一位的中心处始终有跳变，位开始边界有跳变=0，位开始边界没有跳变=1

### 2.4 基本的带通调制方法

- **调幅（AM）**载波的振幅随基带数字信号变化，例如1或0分别对应无载波和有载波输出。

- **调频（FM）** 载波的频率随基带数字信号变化，例如1或0分别对应频率f1或f2。

- **调相（PM）**载波的初始相位随基带数字信号变化，例如1或0分别对应相位0度或180度。

为达到更高信息传输速率，必须采用技术上更为复杂的多元制的振幅相位混合调制，如正交振幅调制QAM。

![image-20200708193645465](计算机网络复习笔记.assets/image-20200708193645465.png)



### 2.5 信道的极限容量

> 信道能通过的频率范围

**奈氏准则**：在任何信道上，码元传输的速率是有上限的，传输速率超过此上限，就会出现严重的码间串扰的问题，使接收端对码元的判决成为不可能。

信道的频带越宽，能够通过的信号高频分量越多，那么就可以用更高的速度传输码元而不出现码间串扰。

> 信噪比

**信噪比**即信号的平均功率和噪声的平均功率之比，记为S/N，用分贝（dB）作为度量单位。
$$
信噪比(dB) = 10log_{10}(S/N)(dB)
$$

$$
C(信道中的极限传输速率) = W(信道的带宽) log_2(1+S/N)
$$

信道的带宽或者信道中的信噪比越大，信息的极限传输速率就越高。



## 三、数据链路层

### 3.1 点对点通信

> 通信主要步骤

- 结点A的数据链路层把网络层交下来的IP数据报添加首部和尾部封装成帧
- 结点A把封装好的帧发送给结点B的数据链路层
- 若结点B的数据链路层收到的帧无差错，则提取出IP数据报上交网络层，否则丢弃这个帧

> 点对点使用的协议

点对点通信使用的是PPP协议，用户到ISP的链路使用PPP协议。

### 3.2 三个基本问题

> 封装成帧

**封装成帧**，就是在一段数据的前后分别添加首部（SOH）和尾部（EOT），这样就构成了一个帧。

> 透明传输

帧的开头和结尾都是特定的控制字符，但是在帧的数据部分是有可能存在这些字符的，因此为了防止被错误的解析，就有了透明传输。这些控制字符确实存在在数据中，但是不会被识别。

**字节填充**：在控制字符前插入一个转义字符ESC。如果数据部分出现转义字符，那么就在转义字符前面再加个转义字符。在接收端进行处理之后可以还原出原始数据。这个过程透明传输的内容是转义字符，用户察觉不到转义字符的存在。

> 差错检测

比特在传输过程中可能产生差错：1可能变成0，0可能变成1，这就叫比特差错。在数据链路层广泛使用了**循环冗余检验CRC**。



### 3.3 CSMA/CD协议

在广播通信中主要使用CSMA/CD协议

CSMA/CD 表示载波监听多点接入 / 碰撞检测。

-   **多点接入**  ：说明这是总线型网络，许多主机以多点的方式连接到总线上。
-   **载波监听**  ：每个主机都必须不停地监听信道。在发送前，如果监听到信道正在使用，就必须等待。
-   **碰撞检测**  ：在发送中，如果监听到信道已有其它主机正在发送数据，就表示发生了碰撞。虽然每个主机在发送数据之前都已经监听到信道为空闲，但是由于电磁波的传播时延的存在，还是有可能会发生碰撞。

记端到端的传播时延为 τ，最先发送的站点最多经过 2τ 就可以知道是否发生了碰撞，称 2τ 为   **争用期**  。只有经过争用期之后还没有检测到碰撞，才能肯定这次发送不会发生碰撞。

当发生碰撞时，站点要停止发送，等待一段时间再发送。这个时间采用   **截断二进制指数退避算法**   来确定。从离散的整数集合 {0, 1, .., (2<sup>k</sup>-1)} 中随机取出一个数，记作 r，然后取 r 倍的争用期作为重传等待时间。



### 3.4 MAC地址

在局域网中，硬件地址又称为物理地址或MAC地址。

MAC 地址是链路层地址，长度为 6 字节（48 位），用于唯一标识网络适配器（网卡）。

一台主机拥有多少个网络适配器就有多少个 MAC 地址。例如笔记本电脑普遍存在无线网络适配器和有线网络适配器，因此就有两个 MAC 地址。



### 3.5 以太网

以太网是一种星型拓扑结构局域网。

早期使用集线器进行连接，集线器是一种物理层设备， 作用于比特而不是帧，当一个比特到达接口时，集线器重新生成这个比特，并将其能量强度放大，从而扩大网络的传输距离，之后再将这个比特发送到其它所有接口。如果集线器同时收到两个不同接口的帧，那么就发生了碰撞。

目前以太网使用交换机替代了集线器，交换机是一种链路层设备，它不会发生碰撞，能根据 MAC 地址进行存储转发。

以太网帧格式：

-   **类型**  ：标记上层使用的协议；
-   **数据**  ：长度在 46-1500 之间，如果太小则需要填充；
-   **FCS**  ：帧检验序列，使用的是 CRC 检验方法；

![image-20200714185020981](计算机网络复习笔记.assets/image-20200714185020981.png)



### 3.6 交换机

交换机具有自学习能力，学习的是交换表的内容，交换表中存储着 MAC 地址到接口的映射。

正是由于这种自学习能力，因此交换机是一种即插即用设备，不需要网络管理员手动配置交换表内容。

下图中，交换机有 4 个接口，主机 A 向主机 B 发送数据帧时，交换机把主机 A 到接口 1 的映射写入交换表中。为了发送数据帧到 B，先查交换表，此时没有主机 B 的表项，那么主机 A 就发送广播帧，主机 C 和主机 D 会丢弃该帧，主机 B 回应该帧向主机 A 发送数据包时，交换机查找交换表得到主机 A 映射的接口为 1，就发送数据帧到接口 1，同时交换机添加主机 B 到接口 2 的映射。

![image-20200714185700228](计算机网络复习笔记.assets/image-20200714185700228.png)



### 3.7 虚拟以太网

虚拟局域网可以建立与物理位置无关的逻辑组，只有在同一个虚拟局域网中的成员才会收到链路层广播信息。

例如下图中 (A1, A2, A3, A4) 属于一个虚拟局域网，A1 发送的广播会被 A2、A3、A4 收到，而其它站点收不到。

使用 VLAN 干线连接来建立虚拟局域网，每台交换机上的一个特殊接口被设置为干线接口，以互连 VLAN 交换机。IEEE 定义了一种扩展的以太网帧格式 802.1Q，它在标准以太网帧上加进了 4 字节首部 VLAN 标签，用于表示该帧属于哪一个虚拟局域网。

![image-20200714193335229](计算机网络复习笔记.assets/image-20200714193335229.png)



## 四、网络层





















